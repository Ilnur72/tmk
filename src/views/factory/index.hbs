<div
  class="md:max-w-auto min-h-screen min-w-0 max-w-full flex-1 rounded-[30px] bg-slate-100 px-4 pb-10 before:block before:h-px before:w-full before:content-[''] dark:bg-darkmode-700 md:px-[22px]"
>
  <!-- BEGIN: Top Bar -->

  <!-- END: Top Bar -->
  <div class='grid grid-cols-12 gap-6'>
    <div class='col-span-12 mt-8'>
      <div class='intro-y flex h-10 items-center'>
        <h2 class='mr-5 truncate text-lg font-medium'>Инвестиция лойиҳалари
          ҳолати мониторинги</h2>
        <a class='ml-auto flex items-center text-primary' href=''>
          <svg
            xmlns='http://www.w3.org/2000/svg'
            width='24'
            height='24'
            viewBox='0 0 24 24'
            fill='none'
            stroke='currentColor'
            stroke-width='2'
            stroke-linecap='round'
            stroke-linejoin='round'
            data-lucide='refresh-ccw'
            class='lucide lucide-refresh-ccw stroke-1.5 mr-3 h-4 w-4'
          ><path
              d='M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8'
            ></path><path d='M3 3v5h5'></path><path
              d='M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16'
            ></path><path d='M16 16h5v5'></path></svg>
          Reload Data
        </a>
      </div>
      <div class='mt-5 grid grid-cols-12 gap-6'>
        <div class='intro-y col-span-12 sm:col-span-6 xl:col-span-3'>
          <div
            class="relative zoom-in before:box before:absolute before:inset-x-3 before:mt-3 before:h-full before:bg-slate-50 before:content-['']"
          >
            <div class='box p-5'>
              <div class='flex'>
                <svg
                  xmlns='http://www.w3.org/2000/svg'
                  width='24'
                  height='24'
                  viewBox='0 0 24 24'
                  fill='none'
                  stroke='currentColor'
                  stroke-width='2'
                  stroke-linecap='round'
                  stroke-linejoin='round'
                  data-lucide='shopping-cart'
                  class='lucide lucide-shopping-cart stroke-1.5 h-[28px] w-[28px] text-primary'
                ><circle cx='8' cy='21' r='1'></circle><circle
                    cx='19'
                    cy='21'
                    r='1'
                  ></circle><path
                    d='M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12'
                  ></path></svg>
                <div class='ml-auto'>
                  <div
                    data-placement='top'
                    class='tooltip cursor-pointer flex items-center rounded-full bg-success py-[3px] pl-2 pr-1 text-xs font-medium text-white'
                  >33%
                    <svg
                      xmlns='http://www.w3.org/2000/svg'
                      width='24'
                      height='24'
                      viewBox='0 0 24 24'
                      fill='none'
                      stroke='currentColor'
                      stroke-width='2'
                      stroke-linecap='round'
                      stroke-linejoin='round'
                      data-lucide='chevron-up'
                      class='lucide lucide-chevron-up stroke-1.5 ml-0.5 h-4 w-4'
                    ><path d='m18 15-6-6-6 6'></path></svg>
                  </div>
                </div>
              </div>
              <div class='mt-6 text-3xl font-medium leading-8'>8</div>
              <div class='mt-1 text-base text-slate-500'>Жами лойиҳалар</div>
            </div>
          </div>
        </div>
        <div class='intro-y col-span-12 sm:col-span-6 xl:col-span-3'>
          <div
            class="relative zoom-in before:box before:absolute before:inset-x-3 before:mt-3 before:h-full before:bg-slate-50 before:content-['']"
          >
            <div class='box p-5'>
              <div class='flex'>
                <svg
                  xmlns='http://www.w3.org/2000/svg'
                  width='24'
                  height='24'
                  viewBox='0 0 24 24'
                  fill='none'
                  stroke='currentColor'
                  stroke-width='2'
                  stroke-linecap='round'
                  stroke-linejoin='round'
                  data-lucide='user'
                  class='lucide lucide-user stroke-1.5 h-[28px] w-[28px] text-success'
                ><path
                    d='M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2'
                  ></path><circle cx='12' cy='7' r='4'></circle></svg>
                <div class='ml-auto'>
                  <div
                    data-placement='top'
                    class='tooltip cursor-pointer flex items-center rounded-full bg-success py-[3px] pl-2 pr-1 text-xs font-medium text-white'
                  >22%
                    <svg
                      xmlns='http://www.w3.org/2000/svg'
                      width='24'
                      height='24'
                      viewBox='0 0 24 24'
                      fill='none'
                      stroke='currentColor'
                      stroke-width='2'
                      stroke-linecap='round'
                      stroke-linejoin='round'
                      data-lucide='chevron-up'
                      class='lucide lucide-chevron-up stroke-1.5 ml-0.5 h-4 w-4'
                    ><path d='m18 15-6-6-6 6'></path></svg>
                  </div>
                </div>
              </div>
              <div class='mt-6 text-3xl font-medium leading-8'>4</div>
              <div class='mt-1 text-base text-slate-500'>
                Расмийлаштириш жараёнида
              </div>
            </div>
          </div>
        </div>
        <div class='intro-y col-span-12 sm:col-span-6 xl:col-span-3'>
          <div
            class="relative zoom-in before:box before:absolute before:inset-x-3 before:mt-3 before:h-full before:bg-slate-50 before:content-['']"
          >
            <div class='box p-5'>
              <div class='flex'>
                <svg
                  xmlns='http://www.w3.org/2000/svg'
                  width='24'
                  height='24'
                  viewBox='0 0 24 24'
                  fill='none'
                  stroke='currentColor'
                  stroke-width='2'
                  stroke-linecap='round'
                  stroke-linejoin='round'
                  data-lucide='monitor'
                  class='lucide lucide-monitor stroke-1.5 h-[28px] w-[28px] text-warning'
                ><rect width='20' height='14' x='2' y='3' rx='2'></rect><line
                    x1='8'
                    x2='16'
                    y1='21'
                    y2='21'
                  ></line><line x1='12' x2='12' y1='17' y2='21'></line></svg>
                <div class='ml-auto'>
                  <div
                    data-placement='top'
                    class='tooltip cursor-pointer flex items-center rounded-full bg-success py-[3px] pl-2 pr-1 text-xs font-medium text-white'
                  >12%
                    <svg
                      xmlns='http://www.w3.org/2000/svg'
                      width='24'
                      height='24'
                      viewBox='0 0 24 24'
                      fill='none'
                      stroke='currentColor'
                      stroke-width='2'
                      stroke-linecap='round'
                      stroke-linejoin='round'
                      data-lucide='chevron-up'
                      class='lucide lucide-chevron-up stroke-1.5 ml-0.5 h-4 w-4'
                    ><path d='m18 15-6-6-6 6'></path></svg>
                  </div>
                </div>
              </div>
              <div class='mt-6 text-3xl font-medium leading-8'>23</div>
              <div class='mt-1 text-base text-slate-500'>
                Қурилиш жараёнида
              </div>
            </div>
          </div>
        </div>
        <div class='intro-y col-span-12 sm:col-span-6 xl:col-span-3'>
          <div
            class="relative zoom-in before:box before:absolute before:inset-x-3 before:mt-3 before:h-full before:bg-slate-50 before:content-['']"
          >
            <div class='box p-5'>
              <div class='flex'>
                <svg
                  xmlns='http://www.w3.org/2000/svg'
                  width='24'
                  height='24'
                  viewBox='0 0 24 24'
                  fill='none'
                  stroke='currentColor'
                  stroke-width='2'
                  stroke-linecap='round'
                  stroke-linejoin='round'
                  data-lucide='credit-card'
                  class='lucide lucide-credit-card stroke-1.5 h-[28px] w-[28px] text-pending'
                ><rect width='20' height='14' x='2' y='5' rx='2'></rect><line
                    x1='2'
                    x2='22'
                    y1='10'
                    y2='10'
                  ></line></svg>
                <div class='ml-auto'>
                  <div
                    data-placement='top'
                    class='tooltip cursor-pointer flex items-center rounded-full bg-danger py-[3px] pl-2 pr-1 text-xs font-medium text-white'
                  >2%
                    <svg
                      xmlns='http://www.w3.org/2000/svg'
                      width='24'
                      height='24'
                      viewBox='0 0 24 24'
                      fill='none'
                      stroke='currentColor'
                      stroke-width='2'
                      stroke-linecap='round'
                      stroke-linejoin='round'
                      data-lucide='chevron-down'
                      class='lucide lucide-chevron-down stroke-1.5 ml-0.5 h-4 w-4'
                    ><path d='m6 9 6 6 6-6'></path></svg>
                  </div>
                </div>
              </div>
              <div class='mt-6 text-3xl font-medium leading-8'>2</div>
              <div class='mt-1 text-base text-slate-500'>Ишга тушганлари</div>
            </div>
          </div>
        </div>

      </div>

      <div class='mt-5 grid grid-cols-12 gap-6'>

        <!-- BEGIN: Users Layout -->
        {{#each factories}}<div
            class='intro-y col-span-12 md:col-span-6 lg:col-span-4 xl:col-span-3'
          >
            <div class='box'>
              <div class='p-5'>
                <div
                  class='image-fit h-40 overflow-hidden rounded-md before:absolute before:left-0 before:top-0 before:z-10 before:block before:h-full before:w-full before:bg-gradient-to-t before:from-black before:to-black/10 2xl:h-56'
                >
                  <img
                    class='rounded-md'
                    src='../../../public/image/3.jpg'
                    alt=''
                  />

                  <div class='absolute bottom-0 z-10 px-5 pb-6 text-white'>
                    <a class='block text-base font-medium' href=''>
                    </a>
                    {{this.name}}
                    <a
                      class='flex items-center text-danger'
                      data-tw-toggle='modal'
                      data-tw-target='#factory-edit-modal'
                      href='#'
                      onclick='showFactoryEditModal({{this.id}})'
                    >
                      <svg
                        xmlns='http://www.w3.org/2000/svg'
                        width='24'
                        height='24'
                        viewBox='0 0 24 24'
                        fill='none'
                        stroke='currentColor'
                        stroke-width='2'
                        stroke-linecap='round'
                        stroke-linejoin='round'
                        data-lucide='trash'
                        class='lucide lucide-trash stroke-1.5 mr-1 h-4 w-4'
                      ><path d='M3 6h18'></path><path
                          d='M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6'
                        ></path><path
                          d='M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2'
                        ></path></svg>
                      Edit
                    </a>
                  </div>
                </div>
                <div class='mt-5 text-slate-600 dark:text-slate-500'>

                  <div class='p-5'>
                    <div
                      class='preview relative [&amp;.hide]:overflow-hidden [&amp;.hide]:h-0'
                    >
                      <div
                        class='w-full bg-slate-200 rounded dark:bg-black/20 mt-3 h-4'
                      >
                        <div
                          role='progressbar'
                          aria-valuenow='0'
                          aria-valuemin='0'
                          aria-valuemax='100'
                          class='bg-primary h-full rounded text-xs text-white flex justify-center items-center w-50'
                        >
                          {{this.work_persent}}%
                        </div>
                      </div>
                    </div>

                  </div>

                  {{#each this.factoryParams}}<div onclick="showParameterModal({{../this.id}}, {{this.param.id}}, '{{this.param.name}}', '{{this.param.type}}', {{this.id}})" class='mt-2 flex items-center cursor-pointer'>
                    <svg
                      xmlns='http://www.w3.org/2000/svg'
                      width='24'
                      height='24'
                      viewBox='0 0 24 24'
                      fill='none'
                      stroke='currentColor'
                      stroke-width='2'
                      stroke-linecap='round'
                      stroke-linejoin='round'
                      data-lucide='check-square'
                      class='lucide lucide-check-square stroke-1.5 mr-2 h-4 w-4'
                    ><polyline points='9 11 12 14 22 4'></polyline><path
                        d='M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11'
                      ></path></svg>
                  <span class="cursor-pointer"  data-param-id="{{this.param.id}}">

                    {{this.param.name}}: &nbsp;
                  </span>
                    <img
                      id='{{this.param.id}}');
                      class='rounded-full'
                      {{#if (eq this.status 0)}}
                        src='../../../public/image/error.png'
                      {{else if (eq this.status 1)}}
                        src='../../../public/image/ok.png'
                      {{else}}
                        src='../../../public/image/{{this.status}}.png'
                      {{/if}}
                      alt=''
                      width='20px'
                      height='20px'
                    />
                  </div>
                  <div
                    class='mt-5 w-full border-t border-slate-200/60 dark:border-darkmode-400'
                  ></div>{{/each}}
                </div>
              </div>
              <div
                class='flex items-center justify-center border-t border-slate-200/60 p-5 dark:border-darkmode-400 lg:justify-end'
              >
                <a class='mr-auto flex items-center text-primary' href='#'>
                  <svg
                    xmlns='http://www.w3.org/2000/svg'
                    width='24'
                    height='24'
                    viewBox='0 0 24 24'
                    fill='none'
                    stroke='currentColor'
                    stroke-width='2'
                    stroke-linecap='round'
                    stroke-linejoin='round'
                    data-lucide='eye'
                    class='lucide lucide-eye stroke-1.5 mr-1 h-4 w-4'
                  ><path
                      d='M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z'
                    ></path><circle cx='12' cy='12' r='3'></circle></svg>
                  Батафсил маълумот
                </a>
                <a class='mr-3 flex items-center' href='#'>
                  <svg
                    xmlns='http://www.w3.org/2000/svg'
                    width='24'
                    height='24'
                    viewBox='0 0 24 24'
                    fill='none'
                    stroke='currentColor'
                    stroke-width='2'
                    stroke-linecap='round'
                    stroke-linejoin='round'
                    data-lucide='check-square'
                    class='lucide lucide-check-square stroke-1.5 mr-1 h-4 w-4'
                  ><polyline points='9 11 12 14 22 4'></polyline><path
                      d='M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11'
                    ></path></svg>
                  Маълумотларни янгилаш
                </a>

              </div>
            </div>
          </div>{{/each}}
          
         <div tabindex="-1" data-modal-backdrop="static" id="parameter-modal" aria-hidden="true" class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full">
  <div class="relative p-4 w-1/2 max-w-2xl max-h-full">
    <div class="relative rounded-lg bg-white shadow">
      <!-- Header -->
      <div class="flex items-center justify-between p-4 pb-3">
        <h3 class="text-xl font-medium text-gray-900" id="modal-title">
          Параметр статусини янгилаш
        </h3> 
        <button type="button" class="ml-auto inline-flex items-center text-gray-400 hover:text-gray-500" onclick="closeParameterModal()">
          <svg class="h-5 w-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
          </svg>
        </button>
      </div>
      
      <form id="parameter-form" class="px-4">
        <input type="hidden" id="param-id" name="param_id">
        <input type="hidden" id="factory-id" name="factory_id">
        <input type="hidden" id="factory-param-id" name="factory_param_id">
        
        <div class="space-y-5 pb-5">
          <div>
            <label for="param-status" class="mb-2 block text-base font-normal text-gray-900">Статус</label>
            <select id="param-status" name="status" class="block w-full rounded-md border border-gray-300 bg-white p-2.5 text-base text-gray-900 focus:border-blue-500 focus:ring-blue-500">
              <option value="1">Мавжуд</option>
              <option value="0">Мавжуд эмас</option>
            </select>
          </div>
          <div>
            <label for="param-comment" class="mb-2 block text-base font-normal text-gray-900">Изоҳ</label>
            <textarea id="param-comment" name="comment" rows="4" class="block w-full rounded-md border border-gray-300 bg-white p-2.5 text-base text-gray-400 focus:border-blue-500 focus:ring-blue-500" placeholder="Изоҳ киритинг..."></textarea>
          </div>
        </div>
        
        <div class="border-t py-4 flex space-x-3">
          <button style="background-color: #00a0c6;" type="submit" class="rounded-md  px-6 py-2.5 text-center text-sm font-medium text-white hover:bg-blue-700 focus:outline-none">
            Сақлаш
          </button>
          <button type="button" onclick="closeParameterModal()" class="rounded-md border border-gray-300 bg-white px-6 py-2.5 text-sm font-medium text-gray-500 hover:bg-gray-100">
            Бекор қилиш
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
        <!-- END: Users Layout -->
        <!-- BEGIN: Pagination -->
        <!--        <div class="intro-y col-span-12 flex flex-wrap items-center sm:flex-row sm:flex-nowrap">-->
        <!--            <nav class="w-full sm:mr-auto sm:w-auto">-->
        <!--                <ul class="flex w-full mr-0 sm:mr-auto sm:w-auto">-->
        <!--                    <li class="flex-1 sm:flex-initial">-->
        <!--                        <a class="transition duration-200 border items-center justify-center py-2 rounded-md cursor-pointer focus:ring-4 focus:ring-primary focus:ring-opacity-20 focus-visible:outline-none dark:focus:ring-slate-700 dark:focus:ring-opacity-50 [&amp;:hover:not(:disabled)]:bg-opacity-90 [&amp;:hover:not(:disabled)]:border-opacity-90 [&amp;:not(button)]:text-center disabled:opacity-70 disabled:cursor-not-allowed min-w-0 sm:min-w-[40px] shadow-none font-normal flex border-transparent text-slate-800 sm:mr-2 dark:text-slate-300 px-1 sm:px-3"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="chevrons-left" class="lucide lucide-chevrons-left stroke-1.5 h-4 w-4"><path d="m11 17-5-5 5-5"></path><path d="m18 17-5-5 5-5"></path></svg></a>-->
        <!--                    </li>-->
        <!--                    <li class="flex-1 sm:flex-initial">-->
        <!--                        <a class="transition duration-200 border items-center justify-center py-2 rounded-md cursor-pointer focus:ring-4 focus:ring-primary focus:ring-opacity-20 focus-visible:outline-none dark:focus:ring-slate-700 dark:focus:ring-opacity-50 [&amp;:hover:not(:disabled)]:bg-opacity-90 [&amp;:hover:not(:disabled)]:border-opacity-90 [&amp;:not(button)]:text-center disabled:opacity-70 disabled:cursor-not-allowed min-w-0 sm:min-w-[40px] shadow-none font-normal flex border-transparent text-slate-800 sm:mr-2 dark:text-slate-300 px-1 sm:px-3"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="chevron-left" class="lucide lucide-chevron-left stroke-1.5 h-4 w-4"><path d="m15 18-6-6 6-6"></path></svg></a>-->
        <!--                    </li>-->
        <!--                    <li class="flex-1 sm:flex-initial">-->
        <!--                        <a class="transition duration-200 border items-center justify-center py-2 rounded-md cursor-pointer focus:ring-4 focus:ring-primary focus:ring-opacity-20 focus-visible:outline-none dark:focus:ring-slate-700 dark:focus:ring-opacity-50 [&amp;:hover:not(:disabled)]:bg-opacity-90 [&amp;:hover:not(:disabled)]:border-opacity-90 [&amp;:not(button)]:text-center disabled:opacity-70 disabled:cursor-not-allowed min-w-0 sm:min-w-[40px] shadow-none font-normal flex border-transparent text-slate-800 sm:mr-2 dark:text-slate-300 px-1 sm:px-3">...</a>-->
        <!--                    </li>-->
        <!--                    <li class="flex-1 sm:flex-initial">-->
        <!--                        <a class="transition duration-200 border items-center justify-center py-2 rounded-md cursor-pointer focus:ring-4 focus:ring-primary focus:ring-opacity-20 focus-visible:outline-none dark:focus:ring-slate-700 dark:focus:ring-opacity-50 [&amp;:hover:not(:disabled)]:bg-opacity-90 [&amp;:hover:not(:disabled)]:border-opacity-90 [&amp;:not(button)]:text-center disabled:opacity-70 disabled:cursor-not-allowed min-w-0 sm:min-w-[40px] shadow-none font-normal flex border-transparent text-slate-800 sm:mr-2 dark:text-slate-300 px-1 sm:px-3">1</a>-->
        <!--                    </li>-->
        <!--                    <li class="flex-1 sm:flex-initial">-->
        <!--                        <a class="transition duration-200 border items-center justify-center py-2 rounded-md cursor-pointer focus:ring-4 focus:ring-primary focus:ring-opacity-20 focus-visible:outline-none dark:focus:ring-slate-700 dark:focus:ring-opacity-50 [&amp;:hover:not(:disabled)]:bg-opacity-90 [&amp;:hover:not(:disabled)]:border-opacity-90 [&amp;:not(button)]:text-center disabled:opacity-70 disabled:cursor-not-allowed min-w-0 sm:min-w-[40px] shadow-none font-normal flex border-transparent text-slate-800 sm:mr-2 dark:text-slate-300 px-1 sm:px-3 !box dark:bg-darkmode-400">2</a>-->
        <!--                    </li>-->
        <!--                    <li class="flex-1 sm:flex-initial">-->
        <!--                        <a class="transition duration-200 border items-center justify-center py-2 rounded-md cursor-pointer focus:ring-4 focus:ring-primary focus:ring-opacity-20 focus-visible:outline-none dark:focus:ring-slate-700 dark:focus:ring-opacity-50 [&amp;:hover:not(:disabled)]:bg-opacity-90 [&amp;:hover:not(:disabled)]:border-opacity-90 [&amp;:not(button)]:text-center disabled:opacity-70 disabled:cursor-not-allowed min-w-0 sm:min-w-[40px] shadow-none font-normal flex border-transparent text-slate-800 sm:mr-2 dark:text-slate-300 px-1 sm:px-3">3</a>-->
        <!--                    </li>-->
        <!--                    <li class="flex-1 sm:flex-initial">-->
        <!--                        <a class="transition duration-200 border items-center justify-center py-2 rounded-md cursor-pointer focus:ring-4 focus:ring-primary focus:ring-opacity-20 focus-visible:outline-none dark:focus:ring-slate-700 dark:focus:ring-opacity-50 [&amp;:hover:not(:disabled)]:bg-opacity-90 [&amp;:hover:not(:disabled)]:border-opacity-90 [&amp;:not(button)]:text-center disabled:opacity-70 disabled:cursor-not-allowed min-w-0 sm:min-w-[40px] shadow-none font-normal flex border-transparent text-slate-800 sm:mr-2 dark:text-slate-300 px-1 sm:px-3">...</a>-->
        <!--                    </li>-->
        <!--                    <li class="flex-1 sm:flex-initial">-->
        <!--                        <a class="transition duration-200 border items-center justify-center py-2 rounded-md cursor-pointer focus:ring-4 focus:ring-primary focus:ring-opacity-20 focus-visible:outline-none dark:focus:ring-slate-700 dark:focus:ring-opacity-50 [&amp;:hover:not(:disabled)]:bg-opacity-90 [&amp;:hover:not(:disabled)]:border-opacity-90 [&amp;:not(button)]:text-center disabled:opacity-70 disabled:cursor-not-allowed min-w-0 sm:min-w-[40px] shadow-none font-normal flex border-transparent text-slate-800 sm:mr-2 dark:text-slate-300 px-1 sm:px-3"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="chevron-right" class="lucide lucide-chevron-right stroke-1.5 h-4 w-4"><path d="m9 18 6-6-6-6"></path></svg></a>-->
        <!--                    </li>-->
        <!--                    <li class="flex-1 sm:flex-initial">-->
        <!--                        <a class="transition duration-200 border items-center justify-center py-2 rounded-md cursor-pointer focus:ring-4 focus:ring-primary focus:ring-opacity-20 focus-visible:outline-none dark:focus:ring-slate-700 dark:focus:ring-opacity-50 [&amp;:hover:not(:disabled)]:bg-opacity-90 [&amp;:hover:not(:disabled)]:border-opacity-90 [&amp;:not(button)]:text-center disabled:opacity-70 disabled:cursor-not-allowed min-w-0 sm:min-w-[40px] shadow-none font-normal flex border-transparent text-slate-800 sm:mr-2 dark:text-slate-300 px-1 sm:px-3"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="chevrons-right" class="lucide lucide-chevrons-right stroke-1.5 h-4 w-4"><path d="m6 17 5-5-5-5"></path><path d="m13 17 5-5-5-5"></path></svg></a>-->
        <!--                    </li>-->
        <!--                </ul>-->
        <!--            </nav>-->
        <!--            <select class="disabled:bg-slate-100 disabled:cursor-not-allowed disabled:dark:bg-darkmode-800/50 [&amp;[readonly]]:bg-slate-100 [&amp;[readonly]]:cursor-not-allowed [&amp;[readonly]]:dark:bg-darkmode-800/50 transition duration-200 ease-in-out text-sm border-slate-200 shadow-sm rounded-md py-2 px-3 pr-8 focus:ring-4 focus:ring-primary focus:ring-opacity-20 focus:border-primary focus:border-opacity-40 dark:bg-darkmode-800 dark:border-transparent dark:focus:ring-slate-700 dark:focus:ring-opacity-50 group-[.form-inline]:flex-1 !box mt-3 w-20 sm:mt-0">-->
        <!--                <option>10</option>-->
        <!--                <option>25</option>-->
        <!--                <option>35</option>-->
        <!--                <option>50</option>-->
        <!--            </select>-->
        <!--        </div>-->
        <!-- END: Pagination -->
      </div>
      <!-- BEGIN: Delete Confirmation Modal -->
      <div
        data-tw-backdrop=''
        aria-hidden='true'
        tabindex='-1'
        id='delete-confirmation-modal'
        class='modal group bg-black/60 transition-[visibility,opacity] w-screen h-screen fixed left-0 top-0 [&amp;:not(.show)]:duration-[0s,0.2s] [&amp;:not(.show)]:delay-[0.2s,0s] [&amp;:not(.show)]:invisible [&amp;:not(.show)]:opacity-0 [&amp;.show]:visible [&amp;.show]:opacity-100 [&amp;.show]:duration-[0s,0.4s]'
      >
        <div
          class='w-[90%] mx-auto bg-white relative rounded-md shadow-md transition-[margin-top,transform] duration-[0.4s,0.3s] -mt-16 group-[.show]:mt-16 group-[.modal-static]:scale-[1.05] dark:bg-darkmode-600 sm:w-[460px]'
        >
          <div class='p-5 text-center'>

            <div class='mt-5 text-3xl'>Лойиҳа маълумотларини ўзгартириш</div>
            <div class='mt-2 text-slate-500' id='edit-factory-modal-result'>

            </div>
          </div>
          <div class='px-5 pb-8 text-center'>
            <button
              data-tw-dismiss='modal'
              type='button'
              class='transition duration-200 border shadow-sm inline-flex items-center justify-center py-2 px-3 rounded-md font-medium cursor-pointer focus:ring-4 focus:ring-primary focus:ring-opacity-20 focus-visible:outline-none dark:focus:ring-slate-700 dark:focus:ring-opacity-50 [&amp;:hover:not(:disabled)]:bg-opacity-90 [&amp;:hover:not(:disabled)]:border-opacity-90 [&amp;:not(button)]:text-center disabled:opacity-70 disabled:cursor-not-allowed border-secondary text-slate-500 dark:border-darkmode-100/40 dark:text-slate-300 [&amp;:hover:not(:disabled)]:bg-secondary/20 [&amp;:hover:not(:disabled)]:dark:bg-darkmode-100/10 mr-1 w-24'
            >Cancel</button>
            <button
              type='button'
              class='transition duration-200 border shadow-sm inline-flex items-center justify-center py-2 px-3 rounded-md font-medium cursor-pointer focus:ring-4 focus:ring-primary focus:ring-opacity-20 focus-visible:outline-none dark:focus:ring-slate-700 dark:focus:ring-opacity-50 [&amp;:hover:not(:disabled)]:bg-opacity-90 [&amp;:hover:not(:disabled)]:border-opacity-90 [&amp;:not(button)]:text-center disabled:opacity-70 disabled:cursor-not-allowed bg-danger border-danger text-white dark:border-danger w-24'
            >Delete</button>
          </div>
        </div>
      </div>
      <div
        data-tw-backdrop=''
        aria-hidden='true'
        tabindex='-1'
        id='factory-edit-modal'
        class='modal group bg-black/60 transition-[visibility,opacity] w-screen h-screen fixed left-0 top-0 [&amp;:not(.show)]:duration-[0s,0.2s] [&amp;:not(.show)]:delay-[0.2s,0s] [&amp;:not(.show)]:invisible [&amp;:not(.show)]:opacity-0 [&amp;.show]:visible [&amp;.show]:opacity-100 [&amp;.show]:duration-[0s,0.4s]'
      >
        <div
          class='w-[90%] mx-auto bg-white relative rounded-md shadow-md transition-[margin-top,transform] duration-[0.4s,0.3s] -mt-16 group-[.show]:mt-16 group-[.modal-static]:scale-[1.05] dark:bg-darkmode-600 sm:w-[460px]'
        >
          <div class='p-5 text-center'>

            <div class='mt-5 text-3xl'>Лойиҳа маълумотларини ўзгартириш</div>
            <div class='mt-2 text-slate-500' id='factory-edit-modal-result'>

            </div>
          </div>

        </div>
      </div>
      <!-- END: Delete Confirmation Modal -->
      {{!-- {{> modal}} --}}
    </div>

  </div>
</div>
<script>
  function showFactoryEditModal(id) { fetch('/factory/update/' + id, { method:
  'GET' }).then(response => response.text()).then(data => {
  document.getElementById('factory-edit-modal-result').innerHTML = data;
  $('#factory-edit-modal').modal('show'); }).catch(error => {
  console.log(error); }); } function save_update_factory(factory_id) { var form
  = document.querySelector('#factory-edit-modal form'); var formData = new
  FormData(form); formData.append('factory_id', factory_id);
  fetch('/factory/update/' + factory_id, { method: 'PUT', body: formData })
  .then(response => { if (!response.ok) { throw new Error(`Network response was
  not ok`); } return response.text(); }) .then(data => {
  document.getElementById('factory-edit-modal').classList.remove('show');
  location.reload(); }) .catch(error => { console.error(`There was a problem
  with the fetch operation:`, error); }); }

</script>
<script>
  // Function to show modal when parameter is clicked
  async showParameterModal(factoryId, paramId, paramName, type, factoryParamId) {
    const modal = document.getElementById('parameter-modal');
    const modalTitle = document.getElementById('modal-title');
    const paramIdInput = document.getElementById('param-id');
    const factoryIdInput = document.getElementById('factory-id');
    const factoryParamIdInput = document.getElementById('factory-param-id');
  console.log(type)
    const paramLogs = await fetch(`/factory/log?query[paramId]=${paramId}&query[factoryId]=${factoryId}`)
      .then(response => awat response.json())
      .then(data => {
      console.log(data)
        const item = data[0];
        // Populate the modal with the fetched data
    const statusContainer = document.getElementById('param-status').parentElement;
        
        // Clear existing input/select
        const existingField = document.getElementById('param-status');
        if (existingField) {
          existingField.remove();
        }
        
        let newField;
        
        // Create field based on type
        if (type === 'date') {
          newField = document.createElement('input');
          newField.type = 'date';
          newField.name = 'status';
          newField.id = 'param-status';
          newField.className = 'block w-full rounded-md border border-gray-300 bg-white p-2.5 text-base text-gray-900 focus:border-blue-500 focus:ring-blue-500';
          
          // Set default value for date (current date if no data, or stored date)
          if (item && item.value) {
            // If item.value is a timestamp or date string, convert it
            const dateValue = new Date(item.value);
            if (!isNaN(dateValue.getTime())) {
              newField.value = dateValue.toISOString().split('T')[0];
            }
          } else {
            // Set current date as default
            newField.value = new Date().toISOString().split('T')[0];
          }
        } else {
          // Default to select for 'select' type or any other type
          newField = document.createElement('select');
          newField.name = 'status';
          newField.id = 'param-status';
          newField.className = 'block w-full rounded-md border border-gray-300 bg-white p-2.5 text-base text-gray-900 focus:border-blue-500 focus:ring-blue-500';
          
          // Add options
          const option1 = document.createElement('option');
          option1.value = '1';
          option1.textContent = 'Мавжуд';
          newField.appendChild(option1);
          
          const option2 = document.createElement('option');
          option2.value = '0';
          option2.textContent = 'Мавжуд эмас';
          newField.appendChild(option2);
          
          // Set default value for select
            console.log(item.value)
          if (item && item.value !== undefined) {
            newField.value = item.value;
          }
        }
        
        // Append the new field to the container
        statusContainer.appendChild(newField);
        
        // Populate comment field
        const commentTextarea = document.getElementById('param-comment');
        if (item && item.izoh) {
          commentTextarea.value = item.izoh;
        } else {
          commentTextarea.value = ''; // Clear comment field if no data
        }
      })
      .catch(error => {
        console.error('Error fetching parameter logs:', error);

        if (existingField) {
          existingField.remove();
        }
      });
    
    modalTitle.textContent = `Параметр статусини янгилаш: ${paramName}`;
    paramIdInput.value = paramId;
    factoryIdInput.value = factoryId;
    factoryParamIdInput.value = factoryParamId;

      const statusContainer = document.getElementById('param-status');
    
    modal.classList.remove('hidden');
    modal.classList.add('flex');
  }
  
  // Function to close modal
  function closeParameterModal() {
    const modal = document.getElementById('parameter-modal');
    modal.classList.remove('flex');
    modal.classList.add('hidden');
  }
  
  // Handle form submission
  document.getElementById('parameter-form').addEventListener('submit', function(e) {
    e.preventDefault();
    
    const formData = new FormData(this);
    const factoryId = formData.get('factory_id');
    const factoryParamId = formData.get('factory_param_id');
    const paramId = formData.get('param_id');
    const status = formData.get('status');
    const comment = formData.get('comment');
    
    fetch('/factory/param/update/' + factoryParamId, {
      method: 'PUT',  
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({status: status})
    }).then(response => {
      if (!response.ok) {
        throw new Error('Network response was not ok');
      }
      return response.json();
    }).then(data=> {
       const img = document.getElementById('{{this.param.id}}');
        if (img) {
          if (+data.status === 0) {
            img.src = '../../../public/image/error.png';
          } else if (+data.status === 1) {
            img.src = '../../../public/image/ok.png';
          } else {
            img.src = `../../../public/image/${data.status}.png`;
          }
        }
    }).catch(error => {
      console.error('Error updating parameter:', error);
    });
    
    // Send data to /factory-log endpoint
    fetch('/factory/log', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        factory_id: factoryId,
        params_id: paramId,
        value: status,
        izoh: comment,
        date_update: new Date().toISOString()
      })
    })
    .then(response => {
      if (response.ok) {
        return response.json();
      }
      throw new Error('Network response was not ok');
    })
    .then(data => {
      // Update the UI to reflect the change
      updateParameterStatus(paramId, status);
      closeParameterModal();
      
      // Show success notification
      showNotification('Параметр статуси муваффақиятли янгиланди', 'success');
    })
    .catch(error => {
      console.error('Error:', error);
      showNotification('Хатолик юз берди. Илтимос, қайтадан уриниб кўринг.', 'error');
    });
  });
  
  // Function to update parameter status in UI
  function updateParameterStatus(paramId, status) {
    const paramElement = document.querySelector(`[data-param-id="${paramId}"]`);
    if (paramElement) {
      const statusImgElement = paramElement.querySelector('img');
      if (statusImgElement) {
        statusImgElement.src = status === "1" ? '../../../public/image/ok.png' : '../../../public/image/error.png';
      }
    }
  }
  
  // Function to show notification
  function showNotification(message, type) {
    // Create notification element
    const notification = document.createElement('div');
    notification.className = `fixed top-4 right-4 px-6 py-3 rounded-lg text-white ${type === 'success' ? 'bg-green-500' : 'bg-red-500'} shadow-lg z-50`;
    notification.textContent = message;
    
    // Append to body
    document.body.appendChild(notification);
    
    // Remove after 3 seconds
    setTimeout(() => {
      notification.remove();
    }, 3000);
  }
</script>